CREATE DATABASE sklep;




-- Tworzenie tabeli użytkowników
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role ENUM('admin', 'employee') NOT NULL
);

-- Tworzenie tabeli klientów
CREATE TABLE customers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    surname VARCHAR(100) NOT NULL,
    phone VARCHAR(20) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    birthDate DATE NOT NULL,
    address VARCHAR(255) NOT NULL
);

-- Tworzenie tabeli zamówień
CREATE TABLE orders (
    id INT AUTO_INCREMENT PRIMARY KEY,
    customerId INT NOT NULL,
    orderDate DATETIME DEFAULT NOW(),
    address VARCHAR(255) NOT NULL,
    status ENUM('Nowe', 'W realizacji', 'Zrealizowane') NOT NULL,
    FOREIGN KEY (customerId) REFERENCES customers(id) ON DELETE CASCADE
);

-- Tworzenie tabeli produktów
CREATE TABLE products (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    stock INT NOT NULL
);

-- Tworzenie tabeli produktów w zamówieniach (relacja wiele do wielu)
CREATE TABLE order_items (
    id INT AUTO_INCREMENT PRIMARY KEY,
    orderId INT NOT NULL,
    productId INT NOT NULL,
    quantity INT NOT NULL CHECK (quantity > 0),
    FOREIGN KEY (orderId) REFERENCES orders(id) ON DELETE CASCADE,
    FOREIGN KEY (productId) REFERENCES products(id) ON DELETE CASCADE
);
CREATE TABLE user_logs (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT,
    login_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
-- Dodanie użytkowników
INSERT INTO users (name, email, password, role) VALUES
('Admin', 'admin@sklep.pl', 'admin123', 'admin'),
('Pracownik', 'pracownik@sklep.pl', 'pracownik123', 'employee');

-- Dodanie klientów
INSERT INTO customers (name, surname, phone, email, birthDate, address) VALUES
('Jan', 'Kowalski', '123456789', 'jan@wp.pl', '1990-05-15', 'Warszawa'),
('Anna', 'Nowak', '987654321', 'anna@wp.pl', '1985-11-25', 'Kraków');

-- Dodanie produktów
INSERT INTO products (name, price, stock) VALUES
('Laptop', 2999.99, 10),
('Telefon', 1999.99, 15),
('Monitor', 799.99, 8);

-- Dodanie zamówień
INSERT INTO orders (customerId, address, status) VALUES
(1, 'Warszawa', 'Nowe'),
(2, 'Kraków', 'W realizacji');

-- Przypisanie produktów do zamówień
INSERT INTO order_items (orderId, productId, quantity) VALUES
(1, 1, 1),
(1, 2, 2),
(2, 3, 1);
